/*! Copyright (C) 2009 Microsoft Corporation */
var xmlProxyVersion="0.070208.0";String.prototype.endsWith=function(n){return this.substr(this.length-n.length)==n};var strSearch=document.location.search.toLowerCase(),idx=strSearch.indexOf("domain="),strDomain=strSearch.substring(idx+7);if(strDomain.endsWith("live.com")||strDomain.endsWith("msn.com")||strDomain.endsWith("microsoft.com")||strDomain.endsWith("live.net")||strDomain.endsWith("live-int.com")||strDomain.endsWith("msn-int.com")||strDomain.endsWith("live-func.net")||strDomain.endsWith("live-tst.net")||strDomain.endsWith("msn-ppe.com"))document.location.hostname.toLowerCase().endsWith(strDomain)?document.domain=strDomain:alert("You can't proxy across different primary domains"),window.XMLHttpRequest||(window.XMLHttpRequest=function(){var n;try{return n=new ActiveXObject("MSXML2.XMLHTTP")}catch(t){}try{return n=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}return null}),window.fetchXML=function(n,t,i,r,u){function l(){if(4==f.readyState){if(u&&f.upload)try{f.upload.onprogress=null}catch(t){f.upload.onprogress=function(){}}try{f.onreadystatechange=null}catch(i){f.onreadystatechange=function(){}}n.timer&&clearTimeout(n.timer),r(f,n.c?n.c:n),f=n=null}}function a(){try{f.onreadystatechange=null}catch(t){f.onreadystatechange=function(){}}f.abort(),r(null,n.c?n.c:n),f=n=null}var o=parent.Web&&parent.Web.Network,s="POST",h=o?parent.Web.Browser.isIE():parent.$Browser?parent.$Browser._isIE:parent.$B.IE,c=n.v?n.v==s:n.type==(o?parent.Web.Network.Type.XMLPost:parent.$Network.Type.XMLPost),f=new XMLHttpRequest,e;if(n.timeout&&(n.timer=setTimeout(a,n.timeout)),u&&f.upload)try{f.upload.onprogress=u}catch(v){}if(f.onreadystatechange=l,t&&t.oninvoke&&t.oninvoke.fire(n),c?(f.open(s,n.url,!0),h&&f.setRequestHeader("Accept-Encoding","gzip, deflate")):f.open(n.verb||"GET",n.url,!0),n.headers)for(e in n.headers)f.setRequestHeader(e,n.headers[e]);n.canary&&f.setRequestHeader(n.canary.n,n.canary.v);try{f.send(n.postString)}catch(v){t.onhttperror.fire(f)}return f},window.onload=function(){try{parent&&parent.Web&&parent.Web.Network&&parent.Web.Network.registerProxy(window),parent&&parent.$Network&&parent.$Network.Proxy&&parent.$Network.Proxy._registerProxy&&parent.$Network.Proxy._registerProxy(window)}catch(n){throw new Error("Missing Framework");}};else throw new Error("Invalid Domain");